/**
 * Kissmetrics JS
 * https://github.com/evansolomon/kissmetrics-js
 * Copyright (c) 2013
 * Evan Solomon; Licensed MIT
 */

(function(){var t,e,r,n,o,i,s,u={}.hasOwnProperty,a=function(t,e){function r(){this.constructor=t}for(var n in e)u.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t};o="undefined"!=typeof exports,o===!0&&(s=require("https")),i=function(t){var e,r;return o===!0&&process.version.match(/^v0\.6/)?s.get(t):(null==(r=t.path)&&(t.path=""),e="https://"+t.host+"/"+t.path,o===!0?s.get(e):(new Image).src=e)},r=function(){function t(t,e){this.apiKey=t,this.person=e,this.host="trk.kissmetrics.com",this.queryTypes={record:"e",set:"s",alias:"a"}}return t.prototype.record=function(t,e){return null==e&&(e={}),e._n=t,this._generateQuery("record",e),this},t.prototype.set=function(t){return delete t._n,this._generateQuery("set",t),this},t.prototype.alias=function(t){return this._generateQuery("alias",{_n:t}),this.person=t,this},t.prototype._validateData=function(t){var e,r,n,o;if(!this.apiKey)throw Error("API key required");if(!this.person)throw Error("Person required");for(o=["_t","_d"],r=0,n=o.length;n>r;r++)e=o[r],delete t[e];return t._k=this.apiKey,t._p=this.person},t.prototype._generateQuery=function(t,e){var r,n,o,s,u;return this._validateData(e),o=function(){var t,o;o=[];for(r in e)u=e[r],t=function(){var t,e,o,i;for(o=[r,u],i=[],t=0,e=o.length;e>t;t++)n=o[t],i.push(encodeURIComponent(n));return i}(),r=t[0],u=t[1],o.push(""+r+"="+u);return o}(),s=o.join("&"),this.lastQuery=i({host:this.host,path:""+this.queryTypes[t]+"?"+s})},t}(),o===!0?module.exports=r:this.KissmetricsClient=r,n={get:function(t){return window.localStorage.getItem(t)},set:function(t,e){return window.localStorage.setItem(t,e)},"delete":function(t){return window.localStorage.removeItem(t)}},e={get:function(t){var e,r,n,o;for(t+="=",o=document.cookie.split(/;\s*/),r=0,n=o.length;n>r;r++)if(e=o[r],0===e.indexOf(t))return e.substring(t.length)},set:function(t,e,r){var n;return null==r&&(r={expires:""}),r.expires||(n=new Date,n.setTime(n.getTime()+31536e6),r.expires="expires="+n.toGMTString()),document.cookie=""+t+"="+e+"; "+r.expires+"; path=/"},"delete":function(t){return e.set(t,"",{expires:-1})}},t=function(t){function r(t,o){var i,s,u;null==o&&(o={}),null==(u=o.storage)&&(o.storage=null),this.storage=function(){if(!o.storage)return null!=window.localStorage?n:e;switch(o.storage){case"cookie":return e;case"localStorage":return n;default:return o.storage}}(),s=o.storageKey||"kissmetricsAnon",(i=this.storage.get(s))||this.storage.set(s,i=this.createID()),r.__super__.constructor.call(this,t,i)}return a(r,t),r.prototype.createID=function(){var t,e;return t=function(){var t,r;for(r=[],e=t=0;10>=t;e=++t)r.push((0|65536*(1+Math.random())).toString(16).substring(1));return r}(),t.join("")},r}(r),o!==!0&&(this.AnonKissmetricsClient=t)}).call(this);
//@ sourceMappingURL=min/kissmetrics.min.map